<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Gaol: AI Multiplayer</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.1/socket.io.js"></script>
    <style>
        body { background: #111; color: #0f0; font-family: monospace; padding: 20px; }
        #chat-box { border: 1px solid #333; height: 400px; overflow-y: scroll; padding: 10px; margin-bottom: 10px; }
        .message { margin: 5px 0; }
        .dm { color: #f0f; font-weight: bold; } /* Dungeon Master is Pink */
        .player { color: #0f0; } /* Players are Green */
        .status { color: #888; font-style: italic; }
        input { background: #222; border: 1px solid #444; color: white; padding: 10px; width: 70%; }
        button { padding: 10px; width: 20%; background: #0f0; color: black; border: none; cursor: pointer; }
    </style>
</head>
<body>
    <h1>GAOL TERMINAL</h1>
    
    <div id="login-area">
        <input type="text" id="username" placeholder="Enter Codename">
        <input type="text" id="room" placeholder="Room ID (e.g. room1)">
        <button onclick="joinGame()">Connect</button>
    </div>

    <div id="game-area" style="display:none;">
        <div id="chat-box"></div>
        <input type="text" id="user_input" placeholder="What do you do?">
        <button onclick="sendAction()">Execute</button>
    </div>

    <script>
        var socket = io();
        var currentUser = "";
        var currentRoom = "";

        function joinGame() {
            currentUser = document.getElementById('username').value;
            currentRoom = document.getElementById('room').value;
            if(currentUser && currentRoom) {
                socket.emit('join', {username: currentUser, room: currentRoom});
                document.getElementById('login-area').style.display = 'none';
                document.getElementById('game-area').style.display = 'block';
            }
        }

        function sendAction() {
            var input = document.getElementById('user_input');
            var text = input.value;
            socket.emit('player_action', {username: currentUser, room: currentRoom, message: text});
            input.value = '';
        }

        socket.on('message', function(data) {
            var chat = document.getElementById('chat-box');
            var p = document.createElement('p');
            var cssClass = data.sender === 'Gaol' ? 'dm' : 'player';
            p.innerHTML = `<span class="${cssClass}">[${data.sender}]</span>: ${data.text}`;
            chat.appendChild(p);
            chat.scrollTop = chat.scrollHeight; // Auto scroll
        });

        socket.on('status', function(data) {
            var chat = document.getElementById('chat-box');
            var p = document.createElement('p');
            p.className = 'status';
            p.innerText = `>> SYSTEM: ${data.msg}`;
            chat.appendChild(p);
        });
    </script>
</body>
</html>